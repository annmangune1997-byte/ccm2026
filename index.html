<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Call Center & Delivery Dashboard</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
  h1 { text-align: center; }
  table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  th { background-color: #007BFF; color: white; }
  .green { background-color: #c6f6c6; }
  .yellow { background-color: #fff3c6; }
  .red { background-color: #f6c6c6; }
  .dashboard { display: flex; justify-content: space-around; margin-bottom: 20px; flex-wrap: wrap; }
  .card { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); width: 20%; text-align: center; margin-bottom: 10px; }
  .card h2 { margin: 10px 0; color: #007BFF; }
  input, select { padding: 5px; margin: 5px; }
  .form-container { margin-bottom: 20px; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);}
  button { padding: 7px 12px; margin: 5px; background-color: #007BFF; color: white; border: none; border-radius: 4px; cursor: pointer; }
  button:hover { background-color: #0056b3; }
</style>
</head>
<body>

<h1>Call Center & Delivery Dashboard</h1>

<!-- Dashboard -->
<div class="dashboard">
  <div class="card">
    <h3>Total Orders (CC)</h3>
    <h2 id="totalOrdersCC">0</h2>
  </div>
  <div class="card">
    <h3>Total Picked Up</h3>
    <h2 id="totalPickedUp">0</h2>
  </div>
  <div class="card">
    <h3>Total Orders Delivered</h3>
    <h2 id="totalDelivered">0</h2>
  </div>
  <div class="card">
    <h3>Delivery Success %</h3>
    <h2 id="deliveryRate">0%</h2>
  </div>
  <div class="card">
    <h3>Total Difference</h3>
    <h2 id="totalDifference">0</h2>
  </div>
</div>

<!-- Data Input Form -->
<div class="form-container">
  <h3>Add New Entry</h3>
  <label>Date: <input type="date" id="entryDate"></label>
  <label>Branch: 
    <select id="branchSelect">
      <option>Hamdan St</option>
      <option>Al Khalidiyah</option>
      <option>Shabiya 11</option>
      <option>Muroor</option>
      <option>Al Majaz</option>
      <option>Al Barsha</option>
      <option>Al Satwa</option>
      <option>Al Rigga</option>
    </select>
  </label>
  <label>Orders Received (CC): <input type="number" id="ordersReceived" min="0"></label>
  <label>Picked Up (CC): <input type="number" id="pickedUp" min="0"></label>
  <label>Cancelled (CC): <input type="number" id="cancelledCC" min="0"></label>
  <label>Orders Delivered (DL): <input type="number" id="ordersDelivered" min="0"></label>
  <label>Cancelled (DL): <input type="number" id="cancelledDL" min="0"></label>
  <button onclick="addRow()">Add Entry</button>
</div>

<!-- Filter -->
<div class="form-container">
  <h3>Filter Table</h3>
  <label>Filter by Branch:
    <select id="filterBranch" onchange="applyFilter()">
      <option value="">All</option>
      <option>Hamdan St</option>
      <option>Al Khalidiyah</option>
      <option>Shabiya 11</option>
      <option>Muroor</option>
      <option>Al Majaz</option>
      <option>Al Barsha</option>
      <option>Al Satwa</option>
      <option>Al Rigga</option>
    </select>
  </label>
  <label>Filter by Date: <input type="date" id="filterDate" onchange="applyFilter()"></label>
</div>

<!-- Orders Table -->
<table id="ordersTable">
  <thead>
    <tr>
      <th>Date</th>
      <th>Branch</th>
      <th>Orders Received (CC)</th>
      <th>Picked Up (CC)</th>
      <th>Cancelled (CC)</th>
      <th>Orders Delivered (DL)</th>
      <th>Cancelled (DL)</th>
      <th>Delivery Success</th>
      <th>Difference</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<script>
let tableBody = document.getElementById('ordersTable').getElementsByTagName('tbody')[0];

function addRow() {
  const date = document.getElementById('entryDate').value;
  const branch = document.getElementById('branchSelect').value;
  const ordersReceived = parseInt(document.getElementById('ordersReceived').value) || 0;
  const pickedUp = parseInt(document.getElementById('pickedUp').value) || 0;
  const cancelledCC = parseInt(document.getElementById('cancelledCC').value) || 0;
  const delivered = parseInt(document.getElementById('ordersDelivered').value) || 0;
  const cancelledDL = parseInt(document.getElementById('cancelledDL').value) || 0;

  const newRow = tableBody.insertRow();
  [date, branch, ordersReceived, pickedUp, cancelledCC, delivered, cancelledDL, '', ''].forEach((text, index) => {
    const cell = newRow.insertCell();
    cell.innerText = text;
  });
  updateTable();
}

function updateTable() {
  let totalCC = 0, totalPicked = 0, totalDelivered = 0, totalDiff = 0;

  for (let row of tableBody.rows) {
    const ordersReceived = parseInt(row.cells[2].innerText);
    const pickedUp = parseInt(row.cells[3].innerText);
    const cancelledCC = parseInt(row.cells[4].innerText);
    const delivered = parseInt(row.cells[5].innerText);
    const cancelledDL = parseInt(row.cells[6].innerText);

    const success = delivered;
    const difference = ordersReceived - delivered;

    totalCC += ordersReceived;
    totalPicked += pickedUp;
    totalDelivered += delivered;
    totalDiff += difference;

    row.cells[7].innerText = success;
    row.cells[8].innerText = difference;

    // Coloring difference
    if (difference === 0) row.cells[8].className = 'green';
    else if (difference <= 2) row.cells[8].className = 'yellow';
    else row.cells[8].className = 'red';
  }

  document.getElementById('totalOrdersCC').innerText = totalCC;
  document.getElementById('totalPickedUp').innerText = totalPicked;
  document.getElementById('totalDelivered').innerText = totalDelivered;
  const deliveryRate = totalCC > 0 ? Math.round((totalDelivered / totalCC) * 100) : 0;
  const rateElem = document.getElementById('deliveryRate');
  rateElem.innerText = deliveryRate + '%';
  rateElem.className = deliveryRate >= 90 ? 'green' : (deliveryRate >= 80 ? 'yellow' : 'red');
  document.getElementById('totalDifference').innerText = totalDiff;
}

function applyFilter() {
  const branchFilter = document.getElementById('filterBranch').value;
  const dateFilter = document.getElementById('filterDate').value;

  for (let row of tableBody.rows) {
    const branch = row.cells[1].innerText;
    const date = row.cells[0].innerText;
    row.style.display = 
      ((branchFilter === '' || branch === branchFilter) && 
       (dateFilter === '' || date === dateFilter)) ? '' : 'none';
  }
}

// Initialize if table has preloaded rows
updateTable();
</script>

</body>
</html>
